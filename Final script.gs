// function doGet() {
//   return HtmlService.createHtmlOutput('Index');
// }


// function onOpen() {
//   var ui = SpreadsheetApp.getUi();
//   ui.createMenu('üìú –°–∫—Ä–∏–ø—Ç—ã test-it')
//     .addItem('–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç-–∫–µ–π—Å—ã', 'showTokenPrompt')
//     .addToUi();
// }

// function showTokenPrompt() {
//   var html = HtmlService.createHtmlOutput(
//     '<p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω:</p>' +
//     '<input type="password" id="token" />' +
//     '<br><br>' +
//     '<button onclick="submitAndClose()">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>' +
//     '<script>' +
//     'function submitAndClose() {' +
//     '  google.script.run.createTestCasesWithTag(token);' + // –ó–∞–ø—É—Å–∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
//     '  google.script.host.close();' + // –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ —Å—Ä–∞–∑—É
//     '}' +
//     '</script>'
//   )
//   .setWidth(300)
//   .setHeight(150);
  
//   SpreadsheetApp.getUi().showModalDialog(html, '–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω');
// }

function createTestCasesWithTag() {
// var apiToken = 'TGs5Z3RzYzFINVhBQlBxYThF';
  
  // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (Spreadsheet)
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // –ü–æ–ª—É—á–∞–µ–º –ª–∏—Å—Ç "–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞" –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
  var techSheet = ss.getSheetByName("–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞");
  // –ï—Å–ª–∏ –ª–∏—Å—Ç "–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞" –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
  if (!techSheet) {
    Logger.log('–õ–∏—Å—Ç "–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // –û—á–∏—â–∞–µ–º –≤—Å–µ —è—á–µ–π–∫–∏ —Å—Ç–æ–ª–±—Ü–∞ D, –Ω–∞—á–∏–Ω–∞—è —Å 20-–π —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏
  techSheet.getRange("D20:D").clearContent();
  
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞—á–∏–Ω–∞–µ–º —Å 20-–π —Å—Ç—Ä–æ–∫–∏, —Å—Ç–æ–ª–±–µ—Ü D –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä 4)
  var logRow = 20;
  
  // // –§—É–Ω–∫—Ü–∏—è logToTechSheet –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±–µ—Ü D, –Ω–∞—á–∏–Ω–∞—è —Å logRow, –∏ –∑–∞—Ç–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç logRow
  // function logToTechSheet(message) {
  //   techSheet.getRange(logRow, 4).setValue(message); // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±–µ—Ü D —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
  //   logRow++; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Å—Ç—Ä–æ–∫ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
  // }
  
  // –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —è—á–µ–π–∫–∏ E12 –ª–∏—Å—Ç–∞ "–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞" (—Å—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É)
  var trackerValue = techSheet.getRange("E12").getValue().toString().trim();
  // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—É—Å—Ç–æ–µ, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  if (!trackerValue) {
    logToTechSheet("–°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞");
    return;
  }
  
  // –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä –∑–∞–¥–∞—á–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "QA-150" (—Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ) –∏–∑ trackerValue
  var match = trackerValue.match(/(QA-\d+)/i);
  // –ï—Å–ª–∏ –Ω–æ–º–µ—Ä –∑–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é
  if (!match) {
    logToTechSheet("–°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞");
    return;
  }
  // –ü—Ä–∏–≤–æ–¥–∏–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–¥–∞—á–∏ –∫ –≤–µ—Ä—Ö–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "QA-150")
  var taskNumber = match[1].toUpperCase();
  
  // –°—á–∏—Ç—ã–≤–∞–µ–º projectId –∏–∑ —è—á–µ–π–∫–∏ E14
  var projectId = techSheet.getRange("E14").getValue().toString().trim();
  // –ï—Å–ª–∏ projectId –ø—É—Å—Ç–æ–π, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  if (!projectId) {
    logToTechSheet("projectId –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω");
    return;
  }
  // –°—á–∏—Ç—ã–≤–∞–µ–º parentId –∏–∑ —è—á–µ–π–∫–∏ E15
  var parentId = techSheet.getRange("E15").getValue().toString().trim();
  if (!parentId) {
    logToTechSheet("parentId –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω");
    return;
  }
  // –°—á–∏—Ç—ã–≤–∞–µ–º –∏–º—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –∏–∑ —è—á–µ–π–∫–∏ E13
  var sectionName = techSheet.getRange("E13").getValue().toString().trim();
  if (!sectionName) {
    logToTechSheet("–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ");
    return;
  }
  
  // –ü–æ–ª—É—á–∞–µ–º –ª–∏—Å—Ç "–û—Ü–µ–Ω–∫–∞", –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –∏ —Å–µ–∫—Ü–∏–π
  var sheet = ss.getSheetByName('–û—Ü–µ–Ω–∫–∞');
  
  // –°—á–∏—Ç—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –ª–∏—Å—Ç–∞ "–û—Ü–µ–Ω–∫–∞" (–≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã)
  var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  
  // –ò—â–µ–º –∏–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É" –≤ –º–∞—Å—Å–∏–≤–µ headers
  var clearColumnIndex = -1;
  for (var i = 0; i < headers.length; i++) {
    if (headers[i] === '–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É') {
      clearColumnIndex = i;
      break;
    }
  }
  // –ï—Å–ª–∏ —Å—Ç–æ–ª–±–µ—Ü "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É" –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  if (clearColumnIndex === -1) {
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞ "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" —Å—Ä–µ–¥–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  var typeColumnIndex = -1;
  for (var i = 0; i < headers.length; i++) {
    if (headers[i] === '–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è') {
      typeColumnIndex = i;
      break;
    }
  }
  // –ï—Å–ª–∏ —Å—Ç–æ–ª–±–µ—Ü "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º –∏ –≤—ã—Ö–æ–¥–∏–º
  if (typeColumnIndex === -1) {
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞ "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É, (–º–∏–Ω—É—Ç—ã)" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö
  var prepColumnIndex = -1;
  for (var i = 0; i < headers.length; i++) {
    if (headers[i] === '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É, (–º–∏–Ω—É—Ç—ã)') {
      prepColumnIndex = i;
      break;
    }
  }
  if (prepColumnIndex === -1) { // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É, (–º–∏–Ω—É—Ç—ã)" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞ "–í—Ä–µ–º—è –Ω–∞ –æ–¥–∏–Ω —Ç–µ—Å—Ç, (–º–∏–Ω—É—Ç—ã)" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö
  var testTimeColumnIndex = -1;
  for (var i = 0; i < headers.length; i++) {
    if (headers[i] === '–í—Ä–µ–º—è –Ω–∞ –æ–¥–∏–Ω —Ç–µ—Å—Ç, (–º–∏–Ω—É—Ç—ã)') {
      testTimeColumnIndex = i;
      break;
    }
  }
  if (testTimeColumnIndex === -1) { // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º –∏ –≤—ã—Ö–æ–¥–∏–º
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "–í—Ä–µ–º—è –Ω–∞ –æ–¥–∏–Ω —Ç–µ—Å—Ç, (–º–∏–Ω—É—Ç—ã)" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ (—Å—Ç—Ä–æ–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤)
  var secondRowValues = sheet.getRange(2, 1, 1, sheet.getLastColumn()).getValues()[0];
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è Desktop, Tablet –∏ Mobile –±—Ä–∞—É–∑–µ—Ä–æ–≤
  var desktopColumnIndex = -1, tabletColumnIndex = -1, mobileColumnIndex = -1;
  for (var i = 0; i < secondRowValues.length; i++) {
    if (secondRowValues[i] === "Desktop –ë—Ä–∞—É–∑–µ—Ä—ã") {
      desktopColumnIndex = i; // –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ "Desktop –ë—Ä–∞—É–∑–µ—Ä—ã", —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –∏–Ω–¥–µ–∫—Å
    } else if (secondRowValues[i] === "Tablet –ë—Ä–∞—É–∑–µ—Ä—ã") {
      tabletColumnIndex = i; // –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω "Tablet –ë—Ä–∞—É–∑–µ—Ä—ã", —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–¥–µ–∫—Å
    } else if (secondRowValues[i] === "Mobile –ë—Ä–∞—É–∑–µ—Ä—ã") {
      mobileColumnIndex = i; // –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω "Mobile –ë—Ä–∞—É–∑–µ—Ä—ã", —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–¥–µ–∫—Å
    }
  }
  // –ï—Å–ª–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ –∏–∑ —Å—Ç–æ–ª–±—Ü–æ–≤ –±—Ä–∞—É–∑–µ—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã—Ö–æ–¥–∏–º
  if (desktopColumnIndex === -1) {
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "Desktop –ë—Ä–∞—É–∑–µ—Ä—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  if (tabletColumnIndex === -1) {
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "Tablet –ë—Ä–∞—É–∑–µ—Ä—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  if (mobileColumnIndex === -1) {
    logToTechSheet('–°—Ç–æ–ª–±–µ—Ü "Mobile –ë—Ä–∞—É–∑–µ—Ä—ã" –Ω–µ –Ω–∞–π–¥–µ–Ω');
    return;
  }
  
  // (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ —Å –±—É–∫–≤–µ–Ω–Ω—ã–º–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –æ—Ç A –¥–æ —Å—Ç–æ–ª–±—Ü–∞ –ø–µ—Ä–µ–¥ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É"
  var columns = [];
  for (var i = 0; i < clearColumnIndex; i++) {
    var columnLetter = String.fromCharCode(65 + i); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∏—Å–ª–æ –≤ –±—É–∫–≤—É (A=65)
    columns.push(columnLetter);
  }
  // –õ–æ–≥–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
  logToTechSheet('–°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–æ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É": ' + columns.join(', '));
  
  // --- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –≤ test-it ---
  // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é createSection –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ —Å –∏–º–µ–Ω–µ–º sectionName,
  // projectId –∏ parentId –±–µ—Ä—É—Ç—Å—è –∏–∑ –ª–∏—Å—Ç–∞ "–¢–µ—Ö.—Å—Ç—Ä–∞–Ω–∏—Ü–∞".
  var rootSectionId = createSection(sectionName, projectId, parentId);
  // –ï—Å–ª–∏ –∫–æ—Ä–Ω–µ–≤–æ–π —Ä–∞–∑–¥–µ–ª –Ω–µ —Å–æ–∑–¥–∞–Ω, –ª–æ–≥–∏—Ä—É–µ–º –∏ –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  if (!rootSectionId) {
    logToTechSheet("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π —Ä–∞–∑–¥–µ–ª");
    return;
  }
  // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ currentSections –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º
  var currentSections = [];
  // –ù–∞ —É—Ä–æ–≤–Ω–µ 0 (–ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å) —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π —Ä–∞–∑–¥–µ–ª
  currentSections[0] = { id: rootSectionId, name: sectionName };
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ (–µ—Å–ª–∏ 10 –ø–æ–¥—Ä—è–¥ ‚Äì –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É)
  var emptyRowCount = 0;
  // –ú–∞—Å—Å–∏–≤ testCases –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ API
  var testCases = [];
  
  /**
   * –§—É–Ω–∫—Ü–∏—è createSection –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞ —á–µ—Ä–µ–∑ API test-it.
   * –ï—Å–ª–∏ –≤ –æ—Ç–≤–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –æ—à–∏–±–∫–∏, —Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–æ–∫–∏, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç—å.
   * @param {string} sectionName - –ò–º—è —Ä–∞–∑–¥–µ–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å.
   * @param {string} projectId - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞.
   * @param {string} parentId - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.
   * @param {number} [rowNumber] - (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏–∑ –ª–∏—Å—Ç–∞ "–û—Ü–µ–Ω–∫–∞", –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—É—â–Ω–æ—Å—Ç—å.
   * @return {string|null} - –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç id —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞; –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null.
   */
  function createSection(sectionName, projectId, parentId, rowNumber) {
    var sectionUrl = baseUrl+"/api/v2/sections"; // URL API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞
    // –§–æ—Ä–º–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç payload —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞
    var payload = {
      "name": sectionName,
      "projectId": projectId,
      "attachments": [],
      "parentId": parentId
    };
    // –ó–∞–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (–º–µ—Ç–æ–¥ POST, –∫–æ–Ω—Ç–µ–Ω—Ç —Ç–∏–ø–∞ JSON, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ç.–¥.)
    var options = {
      "method": "post",
      "contentType": "application/json",
      "payload": JSON.stringify(payload),
      "headers": {
        "Authorization": "PrivateToken "+apiToken
      },
      "muteHttpExceptions": true
    };
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞
    var response = UrlFetchApp.fetch(sectionUrl, options);
    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç API
    var responseText = response.getContentText();
    // –õ–æ–≥–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞
    //logToTechSheet("–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏: " + responseText);
    try {
      var json = JSON.parse(responseText);
      // –ï—Å–ª–∏ –≤ –æ—Ç–≤–µ—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–ª—é—á "errors" –∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–æ–∫–∏
      if (json.errors && rowNumber) {
        logToTechSheet("–í–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏ " + rowNumber);
        return null;
      }
      // –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º id —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞
      return json.id;
    } catch(e) {
      // –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ JSON, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null
      return null;
    }
  }
  
  // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –ª–∏—Å—Ç–∞ "–û—Ü–µ–Ω–∫–∞", –Ω–∞—á–∏–Ω–∞—è —Å–æ 3-–π —Å—Ç—Ä–æ–∫–∏ (–∏–Ω–¥–µ–∫—Å 2)
  for (var row = 2; row < sheet.getLastRow(); row++) {
    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –¥–æ —Å—Ç–æ–ª–±—Ü–∞ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É"
    var rowValues = sheet.getRange(row + 1, 1, 1, clearColumnIndex).getValues()[0];
    
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    var typeValue;
    if (typeColumnIndex < clearColumnIndex) {
      typeValue = rowValues[typeColumnIndex];
    } else {
      typeValue = sheet.getRange(row + 1, typeColumnIndex + 1).getValue();
    }
    
    // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –ø—É—Å—Ç–æ–µ –∏ –≤ —Å—Ç—Ä–æ–∫–µ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –Ω–µ–ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–≤ —Å—Ç–æ–ª–±—Ü–∞—Ö –æ—Ç A –¥–æ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É"),
    // —Ç–æ —Å—á–∏—Ç–∞–µ–º —ç—Ç—É —Å—Ç—Ä–æ–∫—É —Å—Ç—Ä–æ–∫–æ–π-—Å–µ–∫—Ü–∏–µ–π.
    if ((!typeValue || typeValue.toString().trim() === "")) {
      var isSectionRow = false;
      // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã –¥–æ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –Ω–µ–ø—É—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
      for (var col = 0; col < clearColumnIndex; col++) {
        if (rowValues[col] && rowValues[col].toString().trim() !== "") {
          isSectionRow = true;
          break;
        }
      }
      // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —è–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ü–∏–µ–π:
      if (isSectionRow) {
        // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ (—É—Ä–æ–≤–Ω—è) –¥–æ "–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É" —Å–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–¥–µ–ª
        for (var col = 0; col < clearColumnIndex; col++) {
          // –°—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—É—â–µ–π —è—á–µ–π–∫–∏
          var cellValue = rowValues[col] ? rowValues[col].toString().trim() : "";
          if (cellValue !== "") {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —Ä–∞–∑–¥–µ–ª:
            // –ï—Å–ª–∏ col == 0, —Ä–æ–¥–∏—Ç–µ–ª—å ‚Äì –∫–æ—Ä–Ω–µ–≤–æ–π —Ä–∞–∑–¥–µ–ª; –∏–Ω–∞—á–µ, –±–µ—Ä–µ–º —Ä–∞–∑–¥–µ–ª –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –∏–∑ currentSections
            var parentSectionId = (col === 0) ? rootSectionId : (currentSections[col - 1] ? currentSections[col - 1].id : rootSectionId);
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª —Å –∏–º–µ–Ω–µ–º cellValue, –ø–µ—Ä–µ–¥–∞–≤–∞—è projectId, parentSectionId –∏ –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ (row+1)
            var newSectionId = createSection(cellValue, projectId, parentSectionId, row + 1);
            if (newSectionId) {
              // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª –≤ –º–∞—Å—Å–∏–≤ currentSections –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
              currentSections[col] = { id: newSectionId, name: cellValue };
              // –û—á–∏—â–∞–µ–º –∑–∞–ø–∏—Å–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π, –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–≥–æ
              for (var k = col + 1; k < clearColumnIndex; k++) {
                currentSections[k] = null;
              }
            }
          }
        }
        // –¢–∞–∫ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ —è–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ü–∏–µ–π, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ
        continue;
      }
    }
    
    // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ü–∏–µ–π, —Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ—ë –∫–∞–∫ —Ç–µ—Å—Ç-–∫–µ–π—Å.
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–º—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–µ–ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫–µ.
    var testCaseName = "";
    var lastNonEmptyColumn = -1;
    for (var col = 0; col < rowValues.length; col++) {
      if (rowValues[col] && rowValues[col].toString().trim() !== "") {
        lastNonEmptyColumn = col;
        testCaseName = rowValues[col].toString().trim();
      }
    }
    // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–∞—è, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ –∏, –µ—Å–ª–∏ –∏—Ö 10 –ø–æ–¥—Ä—è–¥, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
    if (lastNonEmptyColumn === -1) {
      emptyRowCount++;
      if (emptyRowCount >= 10) {
        logToTechSheet('–ó–∞–≤–µ—Ä—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã, –Ω–∞—á–∞—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ test-it');
        break;
      }
      continue;
    }
    // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–µ –ø—É—Å—Ç–∞—è, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
    emptyRowCount = 0;
    
    // –§–æ—Ä–º–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç baseTag –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è".
    // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ "–¢–µ—Å—Ç –∫–µ–π—Å", baseTag –±—É–¥–µ—Ç {name: "—Ç–µ—Å—Ç –∫–µ–π—Å"};
    // –µ—Å–ª–∏ "–ß–µ–∫ –ª–∏—Å—Ç" ‚Äì baseTag = {name: "—á–µ–∫ –ª–∏—Å—Ç"}.
    var baseTag;
    if (typeValue.toString().trim() === "–¢–µ—Å—Ç –∫–µ–π—Å") {
      baseTag = { "name": "—Ç–µ—Å—Ç –∫–µ–π—Å" };
    } else if (typeValue.toString().trim() === "–ß–µ–∫ –ª–∏—Å—Ç") {
      baseTag = { "name": "—á–µ–∫ –ª–∏—Å—Ç" };
    } else {
      // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–º, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–æ–∫–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ
      logToTechSheet('–ù–µ–≤–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è" –≤ —Å—Ç—Ä–æ–∫–µ ' + (row + 1) + ': ' + typeValue);
      continue;
    }
    
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É, (–º–∏–Ω—É—Ç—ã)" –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    var prepValue = (prepColumnIndex < clearColumnIndex) ?
      rowValues[prepColumnIndex] : sheet.getRange(row + 1, prepColumnIndex + 1).getValue();
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ "–í—Ä–µ–º—è –Ω–∞ –æ–¥–∏–Ω —Ç–µ—Å—Ç, (–º–∏–Ω—É—Ç—ã)" –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    var testTimeValue = (testTimeColumnIndex < clearColumnIndex) ?
      rowValues[testTimeColumnIndex] : sheet.getRange(row + 1, testTimeColumnIndex + 1).getValue();
    // –°—É–º–º–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Ç–µ—Å—Ç–∞ (–≤ –º–∏–Ω—É—Ç–∞—Ö)
    var sumMinutes = Number(prepValue) + Number(testTimeValue);
    // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å—É–º–º—É –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (–æ–∫—Ä—É–≥–ª—è–µ–º)
    var duration = Math.round(sumMinutes * 60 * 1000);
    
// –ü–æ–ª—É—á–∞–µ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ç–µ–≥–∏ –¥–ª—è Desktop:
var desktopValue = sheet.getRange(row + 1, desktopColumnIndex + 1).getValue();
var desktopTags = [];
if (desktopValue && typeof desktopValue === 'string') {
  // –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∑–∞–ø—è—Ç–æ–π
  var tokens = desktopValue.split(",");
  for (var j = 0; j < tokens.length; j++) {
    // –û–±—Ä–µ–∑–∞–µ–º –ø—Ä–æ–±–µ–ª—ã —Ç–æ–ª—å–∫–æ —Å –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏, –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã –≤–Ω—É—Ç—Ä–∏
    var token = tokens[j].trim();
    if (token) {
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–≥ –≤–∏–¥–∞ "desktop <token>"
      desktopTags.push({ "name": "desk " + token });
    }
  }
}

// –ü–æ–ª—É—á–∞–µ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ç–µ–≥–∏ –¥–ª—è Tablet:
var tabletValue = sheet.getRange(row + 1, tabletColumnIndex + 1).getValue();
var tabletTags = [];
if (tabletValue && typeof tabletValue === 'string') {
  var tokens = tabletValue.split(",");
  for (var j = 0; j < tokens.length; j++) {
    var token = tokens[j].trim();
    if (token) {
      tabletTags.push({ "name": "tab " + token });
    }
  }
}

// –ü–æ–ª—É—á–∞–µ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ç–µ–≥–∏ –¥–ª—è Mobile:
var mobileValue = sheet.getRange(row + 1, mobileColumnIndex + 1).getValue();
var mobileTags = [];
if (mobileValue && typeof mobileValue === 'string') {
  var tokens = mobileValue.split(",");
  for (var j = 0; j < tokens.length; j++) {
    var token = tokens[j].trim();
    if (token) {
      mobileTags.push({ "name": "mob " + token });
    }
  }
}

    
    // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ç–µ–≥–∏ (desktop, tablet, mobile) –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤
    var finalTags = [].concat(desktopTags, tabletTags, mobileTags);
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, QA-150) –∫ –º–∞—Å—Å–∏–≤—É —Ç–µ–≥–æ–≤
    var updatedTags = finalTags.concat({ "name": taskNumber });
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–¥–µ–ª –¥–ª—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞:
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º currentSections (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –ø–æ —É—Ä–æ–≤–Ω—è–º) –∏ –±–µ—Ä–µ–º —Å–∞–º—ã–π –≥–ª—É–±–æ–∫–∏–π (–ø–æ—Å–ª–µ–¥–Ω–∏–π, –µ—Å–ª–∏ –µ—Å—Ç—å)
    var testCaseSectionId = rootSectionId;
    for (var level = 0; level < clearColumnIndex; level++) {
      if (currentSections[level] && currentSections[level].id) {
        testCaseSectionId = currentSections[level].id;
      }
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—ä–µ–∫—Ç —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –≤ –º–∞—Å—Å–∏–≤ testCases –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ API,
    // –∞ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ (row+1) –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
    testCases.push({
      name: testCaseName,                // –ò–º—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
      tags: updatedTags,                 // –ú–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤ (–±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ + —Ç–µ–≥ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–¥–∞—á–∏)
      duration: duration,                // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
      baseTag: baseTag,                  // –û–±—ä–µ–∫—Ç baseTag, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π —Ç–∏–ø (—Ç–µ—Å—Ç –∫–µ–π—Å –∏–ª–∏ —á–µ–∫ –ª–∏—Å—Ç)
      sectionId: testCaseSectionId,      // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑–¥–µ–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç-–∫–µ–π—Å
      rowNumber: row + 1                 // –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ –ª–∏—Å—Ç–µ "–û—Ü–µ–Ω–∫–∞", –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
    });
  }
  
  // --- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–µ–π—Å–æ–≤ —á–µ—Ä–µ–∑ API test-it ---
  // URL API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤
  var workItemUrl = baseUrl+"/api/v2/workItems";
  // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã –∏–∑ –º–∞—Å—Å–∏–≤–∞ testCases
  for (var i = 0; i < testCases.length; i++) {
    // –§–æ—Ä–º–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç payload –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
    var testCasePayload = {
      "entityTypeName": "TestCases",       // –¢–∏–ø —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
      "description": "",                   // –û–ø–∏—Å–∞–Ω–∏–µ (–ø—É—Å—Ç–æ–µ)
      "state": "NotReady",                 // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
      "priority": "Medium",                // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
      "steps": [                           // –®–∞–≥–∏ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ (–æ–¥–∏–Ω –ø—É—Å—Ç–æ–π —à–∞–≥)
        {
          "action": "",
          "expected": "",
          "testData": "",
          "comments": "",
          "workItemId": ""
        }
      ],
      "preconditionSteps": [],             // –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤)
      "postconditionSteps": [              // –ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è (–æ–¥–∏–Ω –ø—É—Å—Ç–æ–π —à–∞–≥)
        {
          "action": "",
          "expected": "",
          "testData": "",
          "comments": "",
          "workItemId": ""
        }
      ],
      "duration": testCases[i].duration,   // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
      "attributes": {                      // –ê—Ç—Ä–∏–±—É—Ç—ã —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
        "d4c17098-5dfb-42ca-b012-bb68b0804b5e": testCases[i].baseTag.name
      },
      "tags": testCases[i].tags,           // –ú–∞—Å—Å–∏–≤ —Ç–µ–≥–æ–≤
      "name": testCases[i].name,           // –ò–º—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
      "projectId": projectId,              // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
      "sectionId": testCases[i].sectionId   // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑–¥–µ–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–µ—Å—Ç-–∫–µ–π—Å
    };
    
    // –ó–∞–¥–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ —á–µ—Ä–µ–∑ API
    var testCaseOptions = {
      "method": "post",
      "contentType": "application/json",
      "payload": JSON.stringify(testCasePayload),
      "headers": {
        "Authorization": "PrivateToken "+apiToken
      },
      "muteHttpExceptions": true
    };
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –∏ –ø–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç
    var testCaseResponse = UrlFetchApp.fetch(workItemUrl, testCaseOptions);
    var testCaseResponseText = testCaseResponse.getContentText();
    
// –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–æ–±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç –∫–∞–∫ JSON
try {
  var json = JSON.parse(testCaseResponseText);
  // –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ (–µ—Å—Ç—å –ø–æ–ª–µ "id" –∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫)
  if (json.id && !json.errors) {
    logToTechSheet("–í test-it —Å–æ–∑–¥–∞–Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å: " + testCases[i].name);
    SpreadsheetApp.flush();  // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ —Å—Ä–∞–∑—É
  } else {
    // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç—å, –ª–æ–≥–∏—Ä—É–µ–º —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–æ–∫–∏
    logToTechSheet("–í–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏ " + testCases[i].rowNumber);
  }
} catch(e) {
  // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–æ–±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç –∫–∞–∫ JSON, –ª–æ–≥–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–æ–∫–∏
  logToTechSheet("–û—à–∏–±–∫–∞ —Ä–∞–∑–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –∏–∑ —Å—Ç—Ä–æ–∫–∏ " + testCases[i].rowNumber + ": " + testCaseResponseText);
}
  }
   logToTechSheet("–ü–∞—Ä—Å–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã –∑–∞–≤–µ—Ä—à–µ–Ω");
}
